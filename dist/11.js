(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{179:function(e,t,n){"use strict";var r=n(49),a=n(14),l=n(16),o=n(36),u=n(0),i=n.n(u),c=n(205),s=n(37),g=function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e},f=s.b.div(d||(d=g(["\n    position: fixed;\n    height: 100%;\n    width: 100%;\n    background: rgba(255,255,255, 0.5);\n"],["\n    position: fixed;\n    height: 100%;\n    width: 100%;\n    background: rgba(255,255,255, 0.5);\n"]))),b=Object(s.b)(c.a)(h||(h=g(["\n    position: fixed;\n    top: 50%;\n    left: 50%;\n"],["\n    position: fixed;\n    top: 50%;\n    left: 50%;\n"])));var d,h,m=function(){return u.createElement(f,null,u.createElement(b,{size:"large"}))},p=n(73),v=function(e,t,n,r){return new(n||(n=Promise))((function(a,l){function o(e){try{i(r.next(e))}catch(e){l(e)}}function u(e){try{i(r.throw(e))}catch(e){l(e)}}function i(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,u)}i((r=r.apply(e,t||[])).next())}))},y=function(e,t){var n,r,a,l,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return l={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(l[Symbol.iterator]=function(){return this}),l;function u(l){return function(u){return function(l){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(a=2&l[0]?r.return:l[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,l[1])).done)return a;switch(r=0,a&&(l=[2&l[0],a.value]),l[0]){case 0:case 1:a=l;break;case 4:return o.label++,{value:l[1],done:!1};case 5:o.label++,r=l[1],l=[0];continue;case 7:l=o.ops.pop(),o.trys.pop();continue;default:if(!(a=o.trys,(a=a.length>0&&a[a.length-1])||6!==l[0]&&2!==l[0])){o=0;continue}if(3===l[0]&&(!a||l[1]>a[0]&&l[1]<a[3])){o.label=l[1];break}if(6===l[0]&&o.label<a[1]){o.label=a[1],a=l;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(l);break}a[2]&&o.ops.pop(),o.trys.pop();continue}l=t.call(e,o)}catch(e){l=[6,e],r=0}finally{n=a=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,u])}}};t.a=Object(o.c)((function(e){return{userProfile:e.safehub.userProfile}}),(function(e){return Object(l.b)({changePage:function(e){return Object(a.d)(e)},setUserProfile:r.c,setOrganisation:r.b},e)}))((function(e){var t=Object(u.useState)(!1),n=t[0],r=t[1];return Object(u.useEffect)((function(){!function(){v(this,void 0,void 0,(function(){var t,n,a;return y(this,(function(l){switch(l.label){case 0:return l.trys.push([0,7,,8]),[4,Object(p.b)("me")];case 1:return(t=l.sent())&&t.user?[3,2]:(e.changePage("/auth"),[3,6]);case 2:e.setUserProfile(t),r(!0),l.label=3;case 3:return l.trys.push([3,5,,6]),[4,Object(p.b)("organisations/"+t.userId)];case 4:return n=l.sent(),e.setOrganisation(n),[3,6];case 5:return a=l.sent(),console.log(a),[3,6];case 6:return[3,8];case 7:return l.sent(),e.changePage("/auth"),[3,8];case 8:return[2]}}))}))}()}),[]),n?e.children:i.a.createElement(m,null)}))},208:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r=function(e){var t=new Date(e),n=new Date;return n.getFullYear()>t.getFullYear()?n.getFullYear()-t.getFullYear()+" years ago":n.getFullYear()===t.getFullYear()&&n.getMonth()!==t.getMonth()?n.getMonth()-t.getMonth()+" months ago":n.getMonth()===t.getMonth()&&n.getDay()!==t.getDay()?n.getDay()-t.getDay()+" days ago":n.getDay()===t.getDay()&&n.getHours()!==t.getHours()?n.getHours()-t.getHours()+" hours ago":n.getHours()===t.getHours()&&n.getMinutes()!==t.getMinutes()?n.getMinutes()-t.getMinutes()+" minutes ago":"Just now"}},375:function(e,t,n){"use strict";n.r(t);var r,a=n(0),l=n(14),o=n(16),u=n(36),i=n(179),c=n(385),s=n(368),g=n(52),f=n(376),b=n(371),d=n(282),h=n(284),m=n(232),p=n(386),v=n(392),y=n(111),w=n(393),E=n(365),O=n(384),j=n(394),x=n(395),P=n(396),k=n(172),F=n(37),S=n(73),D=n(208),M=n(49),C=function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e},I=function(e,t,n,r){return new(n||(n=Promise))((function(a,l){function o(e){try{i(r.next(e))}catch(e){l(e)}}function u(e){try{i(r.throw(e))}catch(e){l(e)}}function i(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,u)}i((r=r.apply(e,t||[])).next())}))},Y=function(e,t){var n,r,a,l,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return l={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(l[Symbol.iterator]=function(){return this}),l;function u(l){return function(u){return function(l){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(a=2&l[0]?r.return:l[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,l[1])).done)return a;switch(r=0,a&&(l=[2&l[0],a.value]),l[0]){case 0:case 1:a=l;break;case 4:return o.label++,{value:l[1],done:!1};case 5:o.label++,r=l[1],l=[0];continue;case 7:l=o.ops.pop(),o.trys.pop();continue;default:if(!(a=o.trys,(a=a.length>0&&a[a.length-1])||6!==l[0]&&2!==l[0])){o=0;continue}if(3===l[0]&&(!a||l[1]>a[0]&&l[1]<a[3])){o.label=l[1];break}if(6===l[0]&&o.label<a[1]){o.label=a[1],a=l;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(l);break}a[2]&&o.ops.pop(),o.trys.pop();continue}l=t.call(e,o)}catch(e){l=[6,e],r=0}finally{n=a=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,u])}}},z=c.a.Title,H=s.a.Search,_=F.b.span(N||(N=C(["\n  font-weight:bold;\n\n  span{\n    font-weight: normal;\n    font-size: 12px;\n  }\n"],["\n  font-weight:bold;\n\n  span{\n    font-weight: normal;\n    font-size: 12px;\n  }\n"]))),T=Object(F.b)(g.a)(V||(V=C(["\n  margin-bottom: 25px;\n  font-weight:bold;\n"],["\n  margin-bottom: 25px;\n  font-weight:bold;\n"]))),U=Object(F.b)(H)(L||(L=C(["\n  margin-bottom: 25px;\n"],["\n  margin-bottom: 25px;\n"]))),A=F.b.div(q||(q=C(["\n  display: flex;\n  justify-content: space-between;\n"],["\n  display: flex;\n  justify-content: space-between;\n"]))),J=Object(F.b)(j.a)(B||(B=C(["\n  margin-left: 10px;\n  color: #c73737;\n"],["\n  margin-left: 10px;\n  color: #c73737;\n"]))),G=Object(F.b)(x.a)(K||(K=C(["\n  margin-left: 10px;\n  color: #1890ff;\n"],["\n  margin-left: 10px;\n  color: #1890ff;\n"])));!function(e){e[e.Flagging=0]="Flagging",e[e.Deleting=1]="Deleting",e[e.Unflagging=2]="Unflagging"}(r||(r={}));var N,V,L,q,B,K;t.default=Object(u.c)((function(e){return{userProfile:e.safehub.userProfile}}),(function(e){return Object(o.b)({changePage:function(e){return Object(l.d)(e)},setViewedMsg:M.d},e)}))((function(e){var t,n=this,l=Object(a.useState)(null),o=l[0],u=l[1],c=Object(a.useState)(""),s=c[0],g=c[1],j=["#1de9b6","#1890ff"],x=e.userProfile&&e.userProfile.user?e.userProfile.user.email:"",F=Object(a.useState)(0),M=F[0],C=F[1],H=Object(a.useState)(!1),N=H[0],V=H[1],L=Object(a.useState)(null),q=L[0],B=L[1],K=Object(a.useState)(null),Q=K[0],R=K[1],W=function(){return I(n,void 0,void 0,(function(){var e;return Y(this,(function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,Object(S.b)("messages")];case 1:return e=t.sent(),u(e.reverse()),[3,3];case 2:return t.sent(),u([]),[3,3];case 3:return[2]}}))}))};a.useEffect((function(){!function(){I(this,void 0,void 0,(function(){return Y(this,(function(e){switch(e.label){case 0:return[4,W()];case 1:return e.sent(),[2]}}))}))}()}),[]);var X=function(e){var t=e.icon,n=e.text;return a.createElement(f.a,null,a.createElement(t),n)},Z=function(){var t=o?o.filter((function(e){return"Flagged"!==e.status[0]})):[],n=[];try{n=o?o.filter((function(t){return"Flagged"===t.status[0]&&t.username===e.userProfile.user.email})):[]}catch(e){n=[]}console.log(t,n);var r=o?null==o?void 0:o.slice(M,M+10):[];return""!==s?(r&&(r=r.filter((function(e){return e.username.indexOf(s)>-1}))),r):r};return a.createElement(i.a,null,a.createElement("div",{className:"layout"},a.createElement(d.a,null,a.createElement(h.a,{span:2,lg:6}),a.createElement(h.a,{span:20,lg:12},a.createElement(z,null,"Message center"),a.createElement(m.a,{orientation:"left",plain:!0},o?a.createElement("div",null,"Messages total ("+((null===(t=Z())||void 0===t?void 0:t.length)?Z().length:"0")+")"):a.createElement(p.a.Input,{style:{width:100,height:"10px"},active:!0})),a.createElement(A,null,o&&o.length>0?a.createElement(U,{allowClear:!0,onChange:function(e){g(e.currentTarget.value)},placeholder:"Search username",style:{width:200}}):null,a.createElement(T,{size:"large",onClick:function(){e.changePage("/add-message")}},"Add new")),null===o?a.createElement("div",null," ",[1,2,3,4].map((function(e,t){return a.createElement(p.a,{key:t,loading:!0,active:!0,avatar:!0})}))," "):a.createElement(a.Fragment,null,a.createElement(v.b,{itemLayout:"horizontal",dataSource:Z(),renderItem:function(t,n){return a.createElement(v.b.Item,{style:{cursor:"pointer"},onClick:function(){e.setViewedMsg(t),e.changePage("/view-message")},actions:[a.createElement(X,{icon:P.a,text:t.replies.length,key:"list-vertical-message"})]},a.createElement(v.b.Item.Meta,{avatar:a.createElement(y.a,{style:{backgroundColor:n%2==0?j[0]:j[1]},icon:a.createElement(k.a,null)}),title:a.createElement(_,null,t.title," ",a.createElement("span",null,Object(D.a)(t.Created_date))),description:t.username===x?"You":t.username}),"Flagged"===t.status[0]?a.createElement(a.Fragment,null,a.createElement(w.a,{color:"orange"},"Flagged")," "):t.comment,t.username===x?a.createElement(J,{onClick:function(e){e.stopPropagation(),R(r.Deleting),B(t),V(!0)}}):null,"Flagged"===t.status[0]||t.username===x?null:a.createElement(G,{onClick:function(e){e.stopPropagation(),R(r.Flagging),B(t),V(!0)}}))}}),o.length>10?a.createElement(E.a,{defaultCurrent:1,total:o.length,defaultPageSize:10,onChange:function(e){C(10*(e-1))}}):null)),a.createElement(O.a,{title:Q===r.Deleting?"Delete Post":"Flag pos",visible:N,onOk:function(){return I(n,void 0,void 0,(function(){var e,t,a,l;return Y(this,(function(o){switch(o.label){case 0:if(e=null==q?void 0:q._id,Q!==r.Deleting)return[3,5];o.label=1;case 1:return o.trys.push([1,3,,4]),[4,Object(S.a)("messages",e)];case 2:return a=o.sent(),console.log(a),W(),V(!1),b.b.success("Deleted"),[3,4];case 3:return o.sent(),b.b.error("Something went wrong"),[3,4];case 4:return[3,9];case 5:t={title:q.title,comment:q.comment,replies:q.replies,userName:null==q?void 0:q.username,status:Q===r.Flagging?["Flagged"]:["Ok"],Created_date:null==q?void 0:q.Created_date},o.label=6;case 6:return o.trys.push([6,8,,9]),[4,Object(S.d)("messages/"+q._id,t,!0)];case 7:return a=o.sent(),console.log(a),b.b.warning("Comment flagged!"),W(),V(!1),Q===r.Flagging&&(u=(null==q?void 0:q.username)?q.username:"",i="Message has been flagged",I(n,void 0,void 0,(function(){var e;return Y(this,(function(t){switch(t.label){case 0:e={notifications:[{notification:i,userId:u}],userId:u},t.label=1;case 1:return t.trys.push([1,3,,4]),[4,Object(S.d)("notifications",e)];case 2:return t.sent().errors&&b.b.error("Invalid details, try again"),[3,4];case 3:return t.sent(),b.b.error("Invalid details, try again"),[3,4];case 4:return[2]}}))}))),[3,9];case 8:return l=o.sent(),b.b.error("Something went wrong",l),W(),V(!1),[3,9];case 9:return[2]}var u,i}))}))},onCancel:function(){V(!1)}},Q===r.Deleting?a.createElement("p",null,"Are you sure you want to delete this post?"):a.createElement("p",null,"Are you sure you want to flag this post?")))))}))}}]);
//# sourceMappingURL=11.js.map